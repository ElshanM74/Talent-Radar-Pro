<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Talent Radar Pro — интерактивная оценка</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- СТИЛИ -->
    <style>
        :root {
            --bg-body: #f1f3f7;
            --bg-card: #ffffff;
            --primary: #1f4f82;
            --primary-soft: #e5effa;
            --accent: #3c8dd9;
            --text-main: #253044;
            --text-muted: #6b7280;
            --border-soft: #dde3ee;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
        }

        h1, h2, h3 { margin-top: 0; }

        .app-header {
            background: linear-gradient(135deg,#102647 0%,#17365c 60%,#215f91 100%);
            color: #fff;
            padding: 16px 20px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .app-header-inner {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            flex-wrap: wrap;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-mark {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
        }

        .brand-title { font-size: 20px; font-weight: 700; }
        .brand-subtitle { font-size: 12px; opacity: 0.8; }

        .brand-meta {
            font-size: 12px;
            text-align: right;
            opacity: 0.9;
        }

        .app-main {
            max-width: 1100px;
            margin: 20px auto 32px auto;
            padding: 0 16px;
        }

        .card {
            background-color: var(--bg-card);
            border-radius: 12px;
            padding: 18px;
            box-shadow: 0 4px 12px rgba(15,23,42,0.06);
            border: 1px solid var(--border-soft);
            margin-bottom: 18px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #e1e5f0;
            padding: 6px 8px;
            text-align: left;
        }

        th {
            background-color: #f5f7fb;
            font-weight: 600;
        }

        select, input[type="text"] {
            width: 100%;
            padding: 4px 6px;
            border-radius: 6px;
            border: 1px solid #cbd5e1;
            font-size: 14px;
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(60,141,217,0.25);
        }

        .header-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .buttons-row {
            display: flex;
            gap: 10px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        button {
            padding: 9px 18px;
            background-color: var(--accent);
            color: #fff;
            border: none;
            border-radius: 999px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }

        button:hover { background-color: #2d7bbc; }
        button:disabled { background-color: #9ca3af; cursor: default; }

        /* Блок отчёта */
        #report_container {
            display: none;
            background: #ffffff;
            padding: 18px;
            border-radius: 12px;
            border: 1px solid var(--border-soft);
            margin-top: 18px;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 10px;
            margin-bottom: 12px;
        }

        .report-header-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .report-header-meta {
            font-size: 12px;
            color: var(--text-muted);
            text-align: right;
        }

        .result {
            background-color: var(--primary-soft);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #c3d6f3;
        }

        #radarChart {
            max-width: 600px;
            max-height: 420px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        /* PDF-обложка */
        #pdf_wrapper {
            margin: 0 !important;
            padding: 0 !important;
        }

        .pdf-cover {
            padding: 40px 32px;
            background: linear-gradient(135deg,#102647 0%,#17365c 60%,#215f91 100%);
            color: #ffffff;
            margin: 0 !important;
            border-radius: 0 !important;
        }

        .pdf-cover-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .pdf-cover-subtitle {
            font-size: 18px;
            margin-bottom: 20px;
        }

        .pdf-cover-meta {
            font-size: 14px;
            line-height: 1.4;
        }

        .page-break { page-break-before: always; }

        .app-footer {
            border-top: 1px solid #e5e7eb;
            padding: 10px 16px 16px 16px;
            font-size: 12px;
            color: var(--text-muted);
            text-align: center;
            background: #f9fafb;
        }

        @media (max-width: 720px) {
            .app-header-inner { flex-direction: column; align-items: flex-start; }
            .brand-meta { text-align: left; }
            .header-grid { grid-template-columns: 1fr; }
            #radarChart { max-width: 100%; }
        }
    </style>

    <!-- pdf + chart -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<header class="app-header">
    <div class="app-header-inner">
        <div class="brand">
            <div class="brand-mark">TR</div>
            <div>
                <div class="brand-title">Talent Radar Pro</div>
                <div class="brand-subtitle">Система оценки компетенций для госструктур и компаний</div>
            </div>
        </div>
        <div class="brand-meta">
            <div>Individual Competency Profile</div>
            <div>Based on methodology of Elshan Musayev · AI & Public Sector</div>
        </div>
    </div>
</header>

<main class="app-main">
    <!-- Общая шапка формы -->
    <div class="card">
        <h1 style="font-size:20px;margin-bottom:6px;">Оценка по системе Talent Radar Pro</h1>
        <p style="font-size:14px;color:var(--text-muted);margin-bottom:8px;">
            Оцените каждый пункт по шкале от 1 до 5. После заполнения нажмите
            <strong>«Рассчитать»</strong>, чтобы получить профиль компетенций, Radar Chart и PDF-отчёт.
        </p>

        <div class="header-grid">
            <div>
                <label>Имя кандидата:<br>
                    <input type="text" id="candidate_name" placeholder="Например: Алиев Расим">
                </label>
            </div>
            <div>
                <label>Целевая роль / позиция:<br>
                    <input type="text" id="target_role" placeholder="Например: AI-координатор, аналитик, тимлид">
                </label>
            </div>
        </div>
    </div>

    <!-- HARD -->
    <div class="card">
        <h2 style="font-size:18px;">Hard skills (профессиональные навыки)</h2>
        <table>
            <thead><tr><th>Навык</th><th>Оценка</th></tr></thead>
            <tbody>
            <tr><td>Цифровая грамотность</td><td><select id="hard_digital"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Программирование / разработка</td><td><select id="hard_programming"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Аналитика и работа с данными</td><td><select id="hard_analytics"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Управление проектами</td><td><select id="hard_project"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Маркетинг и продажи</td><td><select id="hard_marketing"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Финансы и бюджетирование</td><td><select id="hard_finance"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Другие профильные навыки</td><td><select id="hard_other"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            </tbody>
        </table>
    </div>

    <!-- SOFT -->
    <div class="card">
        <h2 style="font-size:18px;">Soft skills (гибкие навыки)</h2>
        <table>
            <thead><tr><th>Навык</th><th>Оценка</th></tr></thead>
            <tbody>
            <tr><td>Коммуникация</td><td><select id="soft_communication"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Активное слушание</td><td><select id="soft_listening"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Командная работа</td><td><select id="soft_teamwork"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Лидерство</td><td><select id="soft_leadership"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Эмоциональный интеллект</td><td><select id="soft_emotional"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Гибкость</td><td><select id="soft_adaptability"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Креативность</td><td><select id="soft_problem"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Тайм-менеджмент</td><td><select id="soft_time"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Переговоры и конфликты</td><td><select id="soft_conflict"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Презентации / выступления</td><td><select id="soft_presentation"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            </tbody>
        </table>
    </div>

    <!-- УВЕРЕННОСТЬ -->
    <div class="card">
        <h2 style="font-size:18px;">Уверенность в себе и самоэффективность</h2>
        <table>
            <thead><tr><th>Утверждение</th><th>Оценка</th></tr></thead>
            <tbody>
            <tr><td>Я уверенно представляю свои идеи группе.</td><td><select id="conf_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я могу отстаивать своё мнение.</td><td><select id="conf_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я сохраняю спокойствие под давлением.</td><td><select id="conf_3"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я верю в способность достигать целей.</td><td><select id="conf_4"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я быстро восстанавливаюсь после неудач.</td><td><select id="conf_5"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            </tbody>
        </table>
    </div>

    <!-- BIG FIVE -->
    <div class="card">
        <h2 style="font-size:18px;">Черты личности (Big Five)</h2>
        <table>
            <thead><tr><th>Утверждение</th><th>Оценка</th></tr></thead>
            <tbody>
            <tr><td>Мне комфортно в центре внимания.</td><td><select id="big_extraversion_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я заряжаюсь от общения.</td><td><select id="big_extraversion_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>

            <tr><td>Я доверяю людям и иду на компромисс.</td><td><select id="big_agreeableness_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я избегаю конфликтов.</td><td><select id="big_agreeableness_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>

            <tr><td>Я планирую и довожу дела до конца.</td><td><select id="big_conscientiousness_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я соблюдаю сроки и аккуратен в работе.</td><td><select id="big_conscientiousness_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>

            <tr><td>Я часто испытываю стресс и тревогу.</td><td><select id="big_neuroticism_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Мелочи могут меня сильно выбить.</td><td><select id="big_neuroticism_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>

            <tr><td>Мне интересно новое, люблю экспериментировать.</td><td><select id="big_openness_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            <tr><td>Я люблю искусство, музыку, литературу.</td><td><select id="big_openness_2"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
            </tbody>
        </table>

        <div class="buttons-row">
            <button type="button" onclick="calculateResults()">Рассчитать</button>
            <button type="button" id="download_pdf" onclick="downloadPDF()" disabled>Скачать PDF-отчёт</button>
        </div>
    </div>

    <!-- ОТЧЁТ + ГРАФИК -->
    <div id="report_container">
        <div class="report-header">
            <div>
                <div class="report-header-title">Отчёт по системе Talent Radar Pro</div>
                <div style="font-size:12px;color:var(--text-muted);">
                    Индивидуальный профиль компетенций для подбора, развития и кадрового резерва.
                </div>
            </div>
            <div class="report-header-meta">
                <div>Дата формирования: <span id="report_date"></span></div>
                <div>Разработано: Talent Radar · Elshan Musayev</div>
            </div>
        </div>

        <div id="results" class="result"></div>

        <h3 style="margin-top:14px;">Radar Chart</h3>
        <p style="font-size:12px;color:var(--text-muted);">
            Диаграмма показывает силу профиля по ключевым группам компетенций (0–100).
        </p>
        <canvas id="radarChart"></canvas>
    </div>

    <!-- Контейнер для PDF (обложка + отчёт) -->
    <div id="pdf_wrapper" style="display:none;"></div>

</main>

<footer class="app-footer">
    © Talent Radar · Developed by Elshan Musayev
</footer>

<script>
let radarChart = null;

function avg(arr){return arr.reduce((a,b)=>a+b,0)/arr.length;}
function normalize(v){return ((v-1)/4)*100;}

function traitText(type,avg){
    if(type==="extr"){if(avg>=4)return"Выраженная экстраверсия";if(avg<=2)return"Склонность к интроверсии";return"Амбивертный профиль";}
    if(type==="agree"){if(avg>=4)return"Высокая доброжелательность";if(avg<=2)return"Более жёсткая, независимая позиция";return"Умеренная дружелюбность";}
    if(type==="consc"){if(avg>=4)return"Высокая организованность и дисциплина";if(avg<=2)return"Низкая организованность";return"Средняя сознательность";}
    if(type==="neuro"){if(avg>=4)return"Высокая эмоциональная реактивность";if(avg<=2)return"Эмоциональная стабильность";return"Умеренная чувствительность к стрессу";}
    if(type==="open"){if(avg>=4)return"Высокая открытость новому";if(avg<=2)return"Склонность к традиционности";return"Средняя открытость опыту";}
    return "";
}

function calculateResults(){
    const name = document.getElementById("candidate_name").value || "Кандидат";
    const role = document.getElementById("target_role").value || "Не указана";

    const hard = avg([
        +hard_digital.value,
        +hard_programming.value,
        +hard_analytics.value,
        +hard_project.value,
        +hard_marketing.value,
        +hard_finance.value,
        +hard_other.value
    ]);

    const soft = avg([
        +soft_communication.value,
        +soft_listening.value,
        +soft_teamwork.value,
        +soft_leadership.value,
        +soft_emotional.value,
        +soft_adaptability.value,
        +soft_problem.value,
        +soft_time.value,
        +soft_conflict.value,
        +soft_presentation.value
    ]);

    const conf = avg([
        +conf_1.value,
        +conf_2.value,
        +conf_3.value,
        +conf_4.value,
        +conf_5.value
    ]);

    const extr = avg([+big_extraversion_1.value,+big_extraversion_2.value]);
    const agree = avg([+big_agreeableness_1.value,+big_agreeableness_2.value]);
    const consc = avg([+big_conscientiousness_1.value,+big_conscientiousness_2.value]);
    const neuro = avg([+big_neuroticism_1.value,+big_neuroticism_2.value]);
    const open  = avg([+big_openness_1.value,+big_openness_2.value]);

    const hardN = normalize(hard);
    const softN = normalize(soft);
    const confN = normalize(conf);
    const extrN = normalize(extr);
    const agreeN = normalize(agree);
    const conscN = normalize(consc);
    const emoStableN = normalize(6 - neuro);
    const openN = normalize(open);

    const traitsBlockNorm = (extrN+agreeN+conscN+emoStableN+openN)/5;
    const score = hardN*0.3 + softN*0.3 + confN*0.2 + traitsBlockNorm*0.2;

    let summary;
    if(score>=80 && consc>=3.5 && neuro<=3){
        summary = "Сильный кандидат для сложных и ответственных ролей, включая AI/digital-проекты.";
    } else if(score>=60){
        summary = "Перспективный кандидат. Есть хороший потенциал, но есть зоны, которые стоит усилить перед назначением на ключевые роли.";
    } else {
        summary = "Рискованный кандидат для ответственных AI/digital-ролей. Лучше сфокусироваться на базовом развитии и стабильности.";
    }

    const html = `
        <h2 style="margin-top:0;">Результаты оценки: ${name}</h2>
        <p><strong>Целевая роль:</strong> ${role}</p>

        <h3>Итоговый индекс Talent Radar</h3>
        <p><strong>${score.toFixed(0)} / 100</strong></p>
        <p>${summary}</p>

        <h3>Hard skills</h3>
        <p>Средний балл: ${hard.toFixed(2)}</p>

        <h3>Soft skills</h3>
        <p>Средний балл: ${soft.toFixed(2)}</p>

        <h3>Уверенность в себе</h3>
        <p>Средний балл: ${conf.toFixed(2)}</p>

        <h3>Черты личности (Big Five)</h3>
        <ul>
            <li>Экстраверсия — ${extr.toFixed(2)} (${traitText("extr",extr)})</li>
            <li>Дружелюбие — ${agree.toFixed(2)} (${traitText("agree",agree)})</li>
            <li>Сознательность — ${consc.toFixed(2)} (${traitText("consc",consc)})</li>
            <li>Эмоциональная стабильность — ${(6-neuro).toFixed(2)} (${traitText("neuro",neuro)})</li>
            <li>Открытость опыту — ${open.toFixed(2)} (${traitText("open",open)})</li>
        </ul>
    `;

    document.getElementById("results").innerHTML = html;
    document.getElementById("report_container").style.display = "block";
    document.getElementById("report_date").textContent = new Date().toLocaleDateString("ru-RU");
    document.getElementById("download_pdf").disabled = false;

    const ctx = document.getElementById("radarChart").getContext("2d");
    if(radarChart) radarChart.destroy();
    radarChart = new Chart(ctx,{
        type:"radar",
        data:{
            labels:[
                "Hard","Soft","Уверенность",
                "Экстраверсия","Дружелюбие",
                "Сознательность","Эмоц. стабильность","Открытость"
            ],
            datasets:[{
                label:"Профиль компетенций",
                data:[hardN,softN,confN,extrN,agreeN,conscN,emoStableN,openN],
                fill:true,
                pointRadius:3
            }]
        },
        options:{
            responsive:true,
            scales:{ r:{ min:0,max:100,ticks:{stepSize:20} } },
            plugins:{ legend:{display:false} }
        }
    });
}

function downloadPDF(){
    const name = (document.getElementById("candidate_name").value || "Кандидат").trim();
    const role = document.getElementById("target_role").value || "Не указана";
    const report = document.getElementById("report_container");
    const pdfWrapper = document.getElementById("pdf_wrapper");

    if(!report || report.style.display==="none"){
        alert("Сначала нажмите «Рассчитать».");
        return;
    }

    const dateStr = new Date().toLocaleDateString("ru-RU");

    const coverHTML = `
        <div class="pdf-cover">
            <div class="pdf-cover-title">Talent Radar Pro</div>
            <div class="pdf-cover-subtitle">Individual Competency Profile</div>
            <div class="pdf-cover-meta">
                <div><strong>Кандидат:</strong> ${name || "Кандидат"}</div>
                <div><strong>Целевая роль:</strong> ${role}</div>
                <div><strong>Дата формирования:</strong> ${dateStr}</div>
                <div><strong>Организация:</strong> EKM Global Consulting GmbH / EM Consulting</div>
                <div style="margin-top:10px;font-size:12px;">
                    Developed by Elshan Musayev · AI & Public Sector
                </div>
            </div>
        </div>
        <div class="page-break"></div>
    `;

    pdfWrapper.innerHTML = "";
    pdfWrapper.style.display = "block";
    pdfWrapper.insertAdjacentHTML("beforeend", coverHTML);

    const originalParent = report.parentNode;
    const originalNext = report.nextSibling;

    pdfWrapper.appendChild(report);

    const opt = {
        margin: 0,
        filename: "Talent_Radar_" + (name || "Candidate").replace(/\s+/g,"_") + ".pdf",
        image: { type:"jpeg",quality:0.98 },
        html2canvas: { scale:2 },
        jsPDF: { unit:"mm",format:"a4",orientation:"portrait" },
        pagebreak: { mode:["css","avoid-all"] }
    };

    html2pdf().set(opt).from(pdfWrapper).save().then(()=>{
        pdfWrapper.style.display="none";
        if(originalNext){
            originalParent.insertBefore(report,originalNext);
        } else {
            originalParent.appendChild(report);
        }
    }).catch(()=>{
        pdfWrapper.style.display="none";
        if(originalNext){
            originalParent.insertBefore(report,originalNext);
        } else {
            originalParent.appendChild(report);
        }
        alert("Ошибка при формировании PDF.");
    });
}
</script>
</body>
</html>
