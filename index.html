<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talent Radar Pro</title>

    <style>
        body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f1f3f7; }
        .header { background:#17365c; color:white; padding:16px 20px; font-size:20px; font-weight:bold; }
        .container { max-width:900px; margin:20px auto; background:white; padding:20px; border-radius:10px; }
        table { width:100%; border-collapse:collapse; margin-bottom:20px; }
        th,td { border:1px solid #ccc; padding:6px; }
        select,input { width:100%; padding:6px; }
        button { padding:10px 20px; background:#1f4f82; color:white; border:none; border-radius:8px; cursor:pointer; }
        button:hover { background:#143a63; }
        #report_container { display:none; margin-top:20px; padding:20px; background:#eef5ff; border-radius:10px; }
        canvas { max-width:600px; }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="header">Talent Radar Pro — Оценка компетенций</div>

<div class="container">
    <h2>Информация</h2>
    <label>Имя кандидата:
        <input id="candidate_name" type="text" placeholder="Например: Алиев Расим">
    </label>
    <br><br>
    <label>Целевая роль:
        <input id="target_role" type="text" placeholder="AI-координатор, аналитик...">
    </label>

    <h3>Hard skills</h3>
    <table>
        <tr><th>Навык</th><th>Оценка</th></tr>
        <tr><td>Цифровая грамотность</td><td><select id="hard_digital"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Программирование</td><td><select id="hard_programming"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Аналитика</td><td><select id="hard_analytics"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Проекты</td><td><select id="hard_project"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
    </table>

    <h3>Soft skills</h3>
    <table>
        <tr><th>Навык</th><th>Оценка</th></tr>
        <tr><td>Коммуникация</td><td><select id="soft_communication"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Эмпатия</td><td><select id="soft_listening"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Лидерство</td><td><select id="soft_leadership"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
    </table>

    <h3>Уверенность</h3>
    <table>
        <tr><td>Представление идей</td><td><select id="conf_1"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
        <tr><td>Спокойствие под давлением</td><td><select id="conf_3"><option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option></select></td></tr>
    </table>

    <button onclick="calculateResults()">Рассчитать</button>
    <button onclick="downloadPDF()" id="pdf_btn" disabled>Скачать PDF</button>

    <div id="report_container">
        <h2 id="report_title"></h2>
        <div id="results"></div>
        <canvas id="radarChart"></canvas>
    </div>
</div>
<script>
let radarChart = null;

function avg(arr) {
    return arr.reduce((a,b)=>a+b,0) / arr.length;
}

function normalize(val) {
    return ((val - 1) / 4) * 100;
}

function calculateResults() {

    let name = document.getElementById("candidate_name").value || "Кандидат";
    let target = document.getElementById("target_role").value || "Не указана";

    // Hard skills
    let hard = avg([
        +hard_digital.value,
        +hard_programming.value,
        +hard_analytics.value,
        +hard_project.value
    ]);

    // Soft skills
    let soft = avg([
        +soft_communication.value,
        +soft_listening.value,
        +soft_leadership.value
    ]);

    // Confidence
    let conf = avg([
        +conf_1.value,
        +conf_3.value
    ]);

    let hardN = normalize(hard);
    let softN = normalize(soft);
    let confN = normalize(conf);

    let score = hardN * 0.4 + softN * 0.4 + confN * 0.2;

    // Формирование текста отчёта
    let html = `
        <h3>Профиль кандидата: ${name}</h3>
        <p><b>Целевая роль:</b> ${target}</p>

        <h4>Итоговый индекс:</h4>
        <p><b>${score.toFixed(0)} / 100</b></p>

        <h4>Hard skills:</h4>
        <p>${hard.toFixed(2)}</p>

        <h4>Soft skills:</h4>
        <p>${soft.toFixed(2)}</p>

        <h4>Уверенность:</h4>
        <p>${conf.toFixed(2)}</p>
    `;

    document.getElementById("results").innerHTML = html;

    document.getElementById("report_title").innerHTML =
        "Отчёт Talent Radar Pro";

    document.getElementById("report_container").style.display = "block";
    document.getElementById("pdf_btn").disabled = false;

    // Radar chart
    let ctx = document.getElementById("radarChart").getContext("2d");

    if (radarChart) radarChart.destroy();

    radarChart = new Chart(ctx, {
        type: "radar",
        data: {
            labels: ["Hard", "Soft", "Уверенность"],
            datasets: [{
                label: "Профиль компетенций",
                data: [hardN, softN, confN],
                fill: true,
                pointRadius: 4
            }]
        },
        options: {
            responsive: true,
            scales: {
                r: {
                    min: 0,
                    max: 100
                }
            },
            plugins: { legend: { display: false } }
        }
    });
}

function downloadPDF() {
    const report = document.getElementById("report_container");

    if (report.style.display === "none") {
        alert("Сначала рассчитайте отчёт.");
        return;
    }

    let opt = {
        margin: 10,
        filename: "Talent_Radar_Report.pdf",
        html2canvas: { scale: 2 },
        jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
    };

    html2pdf().set(opt).from(report).save();
}
</script>
</body>
</html>
